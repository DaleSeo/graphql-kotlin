<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="search" type="application/opensearchdescription+xml" title="GraphQL Kotlin" href="/graphql-kotlin/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Client Customization | GraphQL Kotlin</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://expediagroup.github.io/graphql-kotlin/docs/client/client-customization"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Client Customization | GraphQL Kotlin"><meta data-react-helmet="true" name="description" content="Ktor HTTP Client Customization"><meta data-react-helmet="true" property="og:description" content="Ktor HTTP Client Customization"><meta data-react-helmet="true" property="og:image" content="https://expediagroup.github.io/graphql-kotlin/img/undraw_online.svg"><meta data-react-helmet="true" name="twitter:image" content="https://expediagroup.github.io/graphql-kotlin/img/undraw_online.svg"><link data-react-helmet="true" rel="shortcut icon" href="/graphql-kotlin/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://expediagroup.github.io/graphql-kotlin/docs/client/client-customization"><link data-react-helmet="true" rel="alternate" href="https://expediagroup.github.io/graphql-kotlin/docs/client/client-customization" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://expediagroup.github.io/graphql-kotlin/docs/client/client-customization" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/graphql-kotlin/assets/css/styles.0445489e.css">
<link rel="preload" href="/graphql-kotlin/assets/js/runtime~main.3ecdce9d.js" as="script">
<link rel="preload" href="/graphql-kotlin/assets/js/main.4c9f0fc2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/graphql-kotlin/"><img src="/graphql-kotlin/img/EG_Icon_White_on_Blue.png" alt="GraphQL Kotlin" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/graphql-kotlin/img/EG_Icon_White_on_Blue.png" alt="GraphQL Kotlin" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GraphQL Kotlin</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ExpediaGroup/graphql-kotlin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/graphql-kotlin/docs/">5.x.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/graphql-kotlin/docs/client/client-customization">5.x.x</a></li><li><a class="dropdown__link" href="/graphql-kotlin/docs/4.x.x/client/client-customization">4.x.x</a></li><li><a class="dropdown__link" href="/graphql-kotlin/docs/3.x.x/client/client-customization">3.x.x</a></li></ul></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/graphql-kotlin/"><img src="/graphql-kotlin/img/EG_Icon_White_on_Blue.png" alt="GraphQL Kotlin" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/graphql-kotlin/img/EG_Icon_White_on_Blue.png" alt="GraphQL Kotlin" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">GraphQL Kotlin</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/ExpediaGroup/graphql-kotlin" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/graphql-kotlin/docs/client/client-customization">5.x.x</a></li><li class="menu__list-item"><a class="menu__link" href="/graphql-kotlin/docs/4.x.x/client/client-customization">4.x.x</a></li><li class="menu__list-item"><a class="menu__link" href="/graphql-kotlin/docs/3.x.x/client/client-customization">3.x.x</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/examples">Examples</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/framework-comparison">GraphQL Frameworks Comparison</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/blogs-and-videos">Blogs &amp; Videos</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Schema Generator</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/schema-generator-getting-started">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Writing schemas with Kotlin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/nullability">Nullability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/arguments">Arguments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/scalars">Scalars</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/enums">Enums</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/lists">Lists</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/interfaces">Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/unions">Unions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/annotations">Annotations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/writing-schemas/nested-arguments">Nested Resolvers and Shared Arguments</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Customizing Schema</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/generator-config">Generator Configuration &amp; Hooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/documenting-fields">Documenting Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/excluding-fields">Excluding Fields</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/renaming-fields">Renaming Fields</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/directives">Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/deprecating-schema">Deprecating Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/restricting-input-output">Restricting Input and Output Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/customizing-schemas/advanced-features">Advanced Features</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Execution</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/fetching-data">Fetching Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/async-models">Async Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/exceptions">Exceptions and Partial Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/data-fetching-environment">Data Fetching Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/contextual-data">Contextual Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/optional-undefined-arguments">Optional Undefined Arguments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/subscriptions">Subscriptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/execution/introspection">Introspection</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Federation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/federation/apollo-federation">Apollo Federation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/federation/federated-schemas">Federated Schemas</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/federation/federated-directives">Federated Directives</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/federation/type-resolution">Federated Type Resolution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/schema-generator/federation/federation-tracing">Federation Tracing</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Server</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/graphql-server">GraphQLServer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/graphql-request-parser">GraphQLRequestParser</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/graphql-context-factory">GraphQLContextFactory</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/graphql-request-handler">GraphQLRequestHandler</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/data-loaders">Data Loaders</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/server-subscriptions">Subscriptions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Spring Server</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-overview">Spring Server Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-schema">Writing Schemas with Spring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-graphql-context">Generating GraphQL Context</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-http-request-response">HTTP Request and Response</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-beans">Automatically Created Beans</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-properties">Configuration Properties</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/server/spring-server/spring-subscriptions">Subscriptions</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Client</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/graphql-kotlin/docs/client/client-overview">Client Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/graphql-kotlin/docs/client/client-features">Client Features</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/graphql-kotlin/docs/client/client-customization">Client Customization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/graphql-kotlin/docs/client/client-serialization">Client Serialization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Build Plugins</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Gradle Plugin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/plugins/gradle-plugin-tasks">Tasks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/plugins/gradle-plugin-usage">Usage</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">Maven Plugin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/plugins/maven-plugin-goals">Goals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/plugins/maven-plugin-usage">Usage</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/graphql-kotlin/docs/plugins/hooks-provider">Schema Generator Hooks Provider</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 5.x.x</span><div class="markdown"><header><h1 class="h1Heading_27L5">Client Customization</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ktor-http-client-customization"></a>Ktor HTTP Client Customization<a class="hash-link" href="#ktor-http-client-customization" title="Direct link to heading">#</a></h2><p><code>GraphQLKtorClient</code> is a thin wrapper on top of <a href="https://ktor.io/docs/client.html" target="_blank" rel="noopener noreferrer">Ktor HTTP Client</a> and supports fully
asynchronous non-blocking communication. It is highly customizable and can be configured with any supported Ktor HTTP
<a href="https://ktor.io/clients/http-client/engines.html" target="_blank" rel="noopener noreferrer">engine</a> and <a href="https://ktor.io/clients/http-client/features.html" target="_blank" rel="noopener noreferrer">features</a>.</p><p>See <a href="https://ktor.io/clients/index.html" target="_blank" rel="noopener noreferrer">Ktor HTTP Client documentation</a> for additional details.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="global-client-customization"></a>Global Client Customization<a class="hash-link" href="#global-client-customization" title="Direct link to heading">#</a></h3><p>A single instance of <code>GraphQLKtorClient</code> can be used to handle many GraphQL operations. You can specify a custom instance
of Ktor <code>HttpClient</code> and a target <code>GraphQLClientSerializer</code>.</p><p>The below example configures a new <code>GraphQLKtorClient</code> to use the <code>OkHttp</code> engine with custom timeouts, adds a default <code>X-MY-API-KEY</code>
header to all requests, and enables basic logging of the requests.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">val okHttpClient = HttpClient(engineFactory = OkHttp) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    engine {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        config {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            connectTimeout(10, TimeUnit.SECONDS)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            readTimeout(60, TimeUnit.SECONDS)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            writeTimeout(60, TimeUnit.SECONDS)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    defaultRequest {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        header(&quot;X-MY-API-KEY&quot;, &quot;someSecretApiKey&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    install(Logging) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger = Logger.DEFAULT</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        level = LogLevel.INFO</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val client = GraphQLKtorClient(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    url = URL(&quot;http://localhost:8080/graphql&quot;),</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    httpClient = okHttpClient</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="per-request-customization"></a>Per Request Customization<a class="hash-link" href="#per-request-customization" title="Direct link to heading">#</a></h3><p>Individual GraphQL requests can be customized through <a href="https://ktor.io/docs/request.html#customizing-requests" target="_blank" rel="noopener noreferrer">HttpRequestBuilder</a>.
You can use this mechanism to specify custom headers, update target url to include custom query parameters, configure
attributes that can be accessed from the pipeline features as well specify timeouts per request.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">val helloWorldQuery = HelloWorldQuery(variables = HelloWorldQuery.Variables(name = &quot;John Doe&quot;))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val result = client.execute(helloWorldQuery) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    header(&quot;X-B3-TraceId&quot;, &quot;0123456789abcdef&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="spring-webclient-customization"></a>Spring WebClient Customization<a class="hash-link" href="#spring-webclient-customization" title="Direct link to heading">#</a></h2><p><code>GraphQLWebClient</code> is a thin wrapper on top of <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/reactive/function/client/WebClient.html" target="_blank" rel="noopener noreferrer">Spring WebClient</a>
that relies on Reactor Netty for fully asynchronous non-blocking communications. If you want to use Jetty instead you will
need to exclude provided <code>io.projectreactor.netty:reactor-netty</code> dependency and instead add <code>org.eclipse.jetty:jetty-reactive-httpclient</code>
dependency.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="global-client-customization-1"></a>Global Client Customization<a class="hash-link" href="#global-client-customization-1" title="Direct link to heading">#</a></h3><p>A single instance of <code>GraphQLWebClient</code> can be used to handle many GraphQL operations and you can customize it by providing
a custom instance of <code>WebClient.Builder</code>. See <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-webclient-customization" target="_blank" rel="noopener noreferrer">Spring documentation</a>
for additional details.</p><p>Example below configures <code>GraphQLWebClient</code> with custom timeouts and adds a default <code>X-MY-API-KEY</code> header to all requests.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">val httpClient: HttpClient = HttpClient.create()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 10_000)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .responseTimeout(Duration.ofMillis(10_000))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val connector: ClientHttpConnector = ReactorClientHttpConnector(httpClient.wiretap(true))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val webClientBuilder = WebClient.builder()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .clientConnector(connector)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .defaultHeader(&quot;X-MY-API-KEY&quot;, &quot;someSecretApiKey&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val client = GraphQLWebClient(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    url = &quot;http://localhost:8080/graphql&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    builder = webClientBuilder</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="per-request-customization-1"></a>Per Request Customization<a class="hash-link" href="#per-request-customization-1" title="Direct link to heading">#</a></h3><p>Individual GraphQL requests can be customized by providing <code>WebClient.RequestBodyUriSpec</code> lambda. You can use this mechanism
to specify custom headers or include custom attributes or query parameters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">val helloWorldQuery = HelloWorldQuery(variables = HelloWorldQuery.Variables(name = &quot;John Doe&quot;))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">val result = client.execute(helloWorldQuery) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    header(&quot;X-B3-TraceId&quot;, &quot;0123456789abcdef&quot;)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-graphql-client"></a>Custom GraphQL Client<a class="hash-link" href="#custom-graphql-client" title="Direct link to heading">#</a></h2><p>GraphQL Kotlin libraries provide generic a <code>GraphQLClient</code> interface as well as Ktor HTTP Client and Spring WebClient based
reference implementations. Both <code>GraphQLKtorClient</code> and <code>GraphQLWebClient</code> are open classes which means you can also
extend them to provide some custom <code>execute</code> logic.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">class CustomGraphQLClient(url: URL) : GraphQLKtorClient(url = url) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    override suspend fun &lt;T: Any&gt; execute(request: GraphQLClientRequest&lt;T&gt;, requestCustomizer: HttpRequestBuilder.() -&gt; Unit): GraphQLClientResponse&lt;T&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // custom init logic</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        val result = super.execute(request, requestCustomizer)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // custom finalize logic</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return result</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="deprecated-field-usage"></a>Deprecated Field Usage<a class="hash-link" href="#deprecated-field-usage" title="Direct link to heading">#</a></h2><p>Build plugins will automatically fail generation of a client if any of the specified query files are referencing
deprecated fields. This ensures that your clients have to explicitly opt-in into deprecated usage by specifying
<code>allowDeprecatedFields</code> configuration option.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="custom-graphql-scalars"></a>Custom GraphQL Scalars<a class="hash-link" href="#custom-graphql-scalars" title="Direct link to heading">#</a></h2><p>By default, custom GraphQL scalars are serialized and <a href="https://kotlinlang.org/docs/reference/type-aliases.html" target="_blank" rel="noopener noreferrer">type-aliased</a>
to a String. GraphQL Kotlin plugins also support custom serialization based on provided configuration.</p><p>In order to automatically convert between custom GraphQL <code>UUID</code> scalar type and <code>java.util.UUID</code>, we first need to create
our custom <code>ScalarConverter</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">package com.example.client</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import com.expediagroup.graphql.client.converter.ScalarConverter</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.UUID</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">class UUIDScalarConverter : ScalarConverter&lt;UUID&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    override fun toScalar(rawValue: Any): UUID = UUID.fromString(rawValue.toString())</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    override fun toJson(value: UUID): Any = value.toString()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And then configure build plugin by specifying</p><ul><li>Custom GraphQL scalar name</li><li>Target JVM class name</li><li>Converter that provides logic to map between GraphQL and Kotlin type</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">graphql {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    packageName = &quot;com.example.generated&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    endpoint = &quot;http://localhost:8080/graphql&quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    customScalars = listOf(GraphQLScalar(&quot;UUID&quot;, &quot;java.util.UUID&quot;, &quot;com.example.UUIDScalarConverter&quot;))</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Custom scalar fields will then be automatically converted to a <code>java.util.UUID</code> type using appropriate converter/serializer.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1uMI tabs__item--active">Jackson</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">kotlinx.serialization</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>Following converters will be generated under <code>com.example.generated.scalars</code> package.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Generated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class AnyToUUIDConverter : StdConverter&lt;Any, UUID&gt;() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  private val converter: UUIDScalarConverter = UUIDScalarConverter()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public override fun convert(`value`: Any): UUID = converter.toScalar(value)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Generated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class UUIDToAnyConverter : StdConverter&lt;UUID, Any&gt;() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  private val converter: UUIDScalarConverter = UUIDScalarConverter()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public override fun convert(`value`: UUID): Any = converter.toJson(value)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Custom scalars fields will then be annotated with Jackson annotations referencing the above converters.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Generated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public data class Result(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @JsonSerialize(converter = UUIDToAnyConverter::class)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @JsonDeserialize(converter = AnyToUUIDConverter::class)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public val custom: UUID,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @JsonSerialize(contentConverter = UUIDToAnyConverter::class)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @JsonDeserialize(contentConverter = AnyToUUIDConverter::class)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public val customList: List&lt;UUID&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><p>Following serializer will be generated under <code>com.example.generated.scalars</code> package.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Generated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public object UUIDSerializer : KSerializer&lt;UUID&gt; {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  private val converter: UUIDScalarConverter = UUIDScalarConverter()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public override val descriptor: SerialDescriptor = PrimitiveSerialDescriptor(&quot;UUID&quot;, STRING)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public override fun serialize(encoder: Encoder, `value`: UUID): Unit {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val encoded = converter.toJson(value)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    encoder.encodeString(encoded.toString())</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public override fun deserialize(decoder: Decoder): UUID {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val jsonDecoder = decoder as JsonDecoder</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val element = jsonDecoder.decodeJsonElement()</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    val rawContent = element.jsonPrimitive.content</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return converter.toScalar(rawContent)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Custom scalars fields will then be annotated with <code>@Serializable</code> annotation referencing the above serializer.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Generated</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">@Serializable</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public data class Result(</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  @Serializable(with = UUIDSerializer::class)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public val custom: UUID,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  public val customList: List&lt;@Serializable(with = UUIDSerializer::class) UUID&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></div><p>See <a href="/graphql-kotlin/docs/plugins/gradle-plugin-tasks">Gradle</a> and <a href="/graphql-kotlin/docs/plugins/maven-plugin-goals">Maven</a> plugin documentation for additional details.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/ExpediaGroup/graphql-kotlin/tree/master/website/docs/client/client-customization.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-11-17T00:20:11.000Z">11/17/2021</time></b> by <b>Jonathan Hollingsworth</b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/graphql-kotlin/docs/client/client-features"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Client Features</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/graphql-kotlin/docs/client/client-serialization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Client Serialization Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ktor-http-client-customization" class="table-of-contents__link">Ktor HTTP Client Customization</a><ul><li><a href="#global-client-customization" class="table-of-contents__link">Global Client Customization</a></li><li><a href="#per-request-customization" class="table-of-contents__link">Per Request Customization</a></li></ul></li><li><a href="#spring-webclient-customization" class="table-of-contents__link">Spring WebClient Customization</a><ul><li><a href="#global-client-customization-1" class="table-of-contents__link">Global Client Customization</a></li><li><a href="#per-request-customization-1" class="table-of-contents__link">Per Request Customization</a></li></ul></li><li><a href="#custom-graphql-client" class="table-of-contents__link">Custom GraphQL Client</a></li><li><a href="#deprecated-field-usage" class="table-of-contents__link">Deprecated Field Usage</a></li><li><a href="#custom-graphql-scalars" class="table-of-contents__link">Custom GraphQL Scalars</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/graphql-kotlin/img/Expedia-Group-Logo_E-Stacked.png" alt="" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/graphql-kotlin/img/Expedia-Group-Logo_E-Stacked.png" alt="" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></div><div class="footer__copyright">Copyright Â© 2021 Expedia, Inc.</div></div></div></footer></div>
<script src="/graphql-kotlin/assets/js/runtime~main.3ecdce9d.js"></script>
<script src="/graphql-kotlin/assets/js/main.4c9f0fc2.js"></script>
</body>
</html>